# Production Environment Configuration for MEF API
# This file contains production-ready settings for the MEF API server

# ============================================================================
# Server Configuration
# ============================================================================

# Server binding
BIND_HOST=0.0.0.0
PORT=8080

# Environment
ENVIRONMENT=production

# ============================================================================
# Security
# ============================================================================

# Authentication
AUTH_TOKEN_REQUIRED=true
# MEF_API_TOKEN should be set via Docker secrets or environment variables
# QUALITY_TOKEN should be set via Docker secrets or environment variables

# ============================================================================
# Logging
# ============================================================================

# Log level: trace, debug, info, warn, error
LOG_LEVEL=info

# Log format: json, text
LOG_FORMAT=json

# ============================================================================
# Metrics and Monitoring
# ============================================================================

# Enable Prometheus metrics
ENABLE_METRICS=true

# Metrics port (different from API port)
METRICS_PORT=9090

# ============================================================================
# Performance
# ============================================================================

# Number of worker threads (0 = number of CPU cores)
WORKER_THREADS=0

# Request timeout in seconds
REQUEST_TIMEOUT=30

# Maximum request body size in MB
MAX_BODY_SIZE_MB=10

# ============================================================================
# Database and Storage
# ============================================================================

# Storage path for data
DATA_PATH=/data

# Ledger storage path
LEDGER_PATH=/data/ledger

# Spiral snapshot storage path
SPIRAL_PATH=/data/spiral

# Vector database configuration
VECTOR_DB_TYPE=hnsw

# HNSW index parameters
HNSW_M=16
HNSW_EF_CONSTRUCTION=200
HNSW_EF_SEARCH=64

# ============================================================================
# Vector Database Integrations
# ============================================================================

# Qdrant configuration
QDRANT_URL=http://qdrant:6333

# Milvus configuration
MILVUS_HOST=milvus
MILVUS_PORT=19530

# ============================================================================
# Resource Limits
# ============================================================================

# Maximum number of concurrent connections
MAX_CONNECTIONS=1000

# Maximum indexing batch size
MAX_BATCH_SIZE=1000

# Memory limit for index (MB)
INDEX_MEMORY_LIMIT_MB=2048

# ============================================================================
# Retry and Timeout Settings
# ============================================================================

# Database operation retry attempts
DB_RETRY_ATTEMPTS=3

# Database operation timeout (seconds)
DB_TIMEOUT_SECONDS=10

# ============================================================================
# Feature Flags
# ============================================================================

# Enable experimental features
ENABLE_EXPERIMENTAL=false

# Enable debug endpoints (should be false in production)
ENABLE_DEBUG_ENDPOINTS=false

# Enable CORS
ENABLE_CORS=true

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=https://infinityledger.io,https://www.infinityledger.io

# ============================================================================
# Health Check Configuration
# ============================================================================

# Health check interval (seconds)
HEALTH_CHECK_INTERVAL=30

# Health check timeout (seconds)
HEALTH_CHECK_TIMEOUT=5

# ============================================================================
# Benchmark and Testing
# ============================================================================

# Disable proof-of-resonance holds in CI (set to 0 for production)
CI_NO_POR_HOLDS=0

# Strict read path (enforce validation)
STRICT_READPATH=true

# ============================================================================
# Rate Limiting
# ============================================================================

# Enable rate limiting
ENABLE_RATE_LIMIT=true

# Requests per second per IP
RATE_LIMIT_RPS=100

# Burst size for rate limiting
RATE_LIMIT_BURST=200

# ============================================================================
# Caching
# ============================================================================

# Enable query result caching
ENABLE_QUERY_CACHE=true

# Cache TTL in seconds
QUERY_CACHE_TTL=300

# Maximum cache size (MB)
QUERY_CACHE_SIZE_MB=512

# ============================================================================
# Backup and Recovery
# ============================================================================

# Enable automatic backups
ENABLE_AUTO_BACKUP=true

# Backup interval (hours)
BACKUP_INTERVAL_HOURS=24

# Backup retention period (days)
BACKUP_RETENTION_DAYS=30

# Backup storage path
BACKUP_PATH=/data/backups

# ============================================================================
# Observability
# ============================================================================

# Enable distributed tracing
ENABLE_TRACING=true

# Tracing sample rate (0.0 to 1.0)
TRACING_SAMPLE_RATE=0.1

# Jaeger endpoint (if tracing is enabled)
# JAEGER_ENDPOINT=http://jaeger:14268/api/traces

# ============================================================================
# Advanced Performance Tuning
# ============================================================================

# Index build parallelism
INDEX_BUILD_THREADS=4

# Search parallelism
SEARCH_THREADS=8

# Batch processing queue size
BATCH_QUEUE_SIZE=10000

# Enable memory-mapped index
USE_MMAP_INDEX=true

# ============================================================================
# Deployment Metadata
# ============================================================================

# Version (set by deployment automation)
# VERSION=1.0.0

# Deployment timestamp (set by deployment automation)
# DEPLOYED_AT=2025-10-15T18:00:00Z

# Deployed by (set by deployment automation)
# DEPLOYED_BY=automation
